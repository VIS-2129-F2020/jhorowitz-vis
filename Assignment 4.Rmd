---
title: "Assignment 4: Network Analysis"
author: "Jennifer Horowitz"
date: "10/2/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```

## R Markdown

```{r}
library(osmdata)
library(opentripplanner)
library(tidyverse)
library(sf)
library(ggthemes)
library(ggspatial)
```

```{r load library locations}
COVIDtesting <- st_read(
  "https://opendata.arcgis.com/datasets/7db7bb2ba2c543a589b0568771926e2f_80.kml")
```

```{r}
opq(bbox = 'Los Angeles CA USA') %>%
  add_osm_feature(key = 'highway') %>%
  osmdata_xml(file = 'OTP/graphs/default/testingsites.osm')
```
```{r}
CA_state_plane <- "+proj=lcc +lat_1=32.78333333333333 +lat_2=33.88333333333333 +lat_0=32.16666666666666 +lon_0=-116.25 +x_0=2000000 +y_0=500000.0000000002 +ellps=GRS80 +datum=NAD83 +to_meter=0.3048006096012192 no_defs"
```




```{r}
latestingsites_features <- opq(bbox = 'Los Angeles CA USA') %>%
  add_osm_feature(key = 'highway') %>%
  osmdata_sf()
```
```{r}
testingsites <- latestingsites_features$osm_lines %>%
  st_transform(crs = CA_state_plane)
```


```{r}
ggplot(testingsites) +
  geom_sf() +
  theme_map()
```
```{r}
##path_otp <- otp_dl_jar("OTP")
```

```{r, message=FALSE, results='hide'}
path_data <- file.path(getwd(), "OTP")
path_otp <- paste(path_data, "otp.jar",sep = "/")
otp_build_graph(otp = path_otp, dir = path_data, memory = 1024) 
```




